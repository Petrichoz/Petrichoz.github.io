

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="https://p0.itc.cn/q_70/images03/20230516/bab1646e504942d4a9d964cde5d8b15d.jpeg">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="pz">
  <meta name="keywords" content="">
  
    <meta name="description" content="第08章_C语言常用函数本章专题脉络   4.2 void 指针(无类型指针) 每一块内存都有地址，通过指针变量可以获取指定地址的内存块。  指针变量必须有类型，否则编译器无法知道如何解读内存块保存的二进制数据。但是，向系统请求内存的时候，有时不确定会有什么样的数据写入内存，需要先获得内存块，稍后再确定写入的数据类型。   综上，为了满足这种需求，C 语言提供了一种不定类型的指针，叫做 void">
<meta property="og:type" content="article">
<meta property="og:title" content="8、C语言常用函数">
<meta property="og:url" content="http://example.com/2025/02/01/%E6%8A%80%E6%9C%AF%E6%A0%88/C/%E7%AC%AC08%E7%AB%A0_C%E8%AF%AD%E8%A8%80%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0/index.html">
<meta property="og:site_name" content="PZ">
<meta property="og:description" content="第08章_C语言常用函数本章专题脉络   4.2 void 指针(无类型指针) 每一块内存都有地址，通过指针变量可以获取指定地址的内存块。  指针变量必须有类型，否则编译器无法知道如何解读内存块保存的二进制数据。但是，向系统请求内存的时候，有时不确定会有什么样的数据写入内存，需要先获得内存块，稍后再确定写入的数据类型。   综上，为了满足这种需求，C 语言提供了一种不定类型的指针，叫做 void">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/c.png">
<meta property="article:published_time" content="2025-02-01T15:45:21.000Z">
<meta property="article:modified_time" content="2025-02-10T08:10:42.000Z">
<meta property="article:author" content="pz">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/img/c.png">
  
  
  
  <title>8、C语言常用函数 - PZ</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":false},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>PZ</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/null') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="8、C语言常用函数"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-02-01 23:45" pubdate>
          2025年2月1日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          3.1k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          26 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">8、C语言常用函数</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="第08章-C语言常用函数"><a href="#第08章-C语言常用函数" class="headerlink" title="第08章_C语言常用函数"></a>第08章_C语言常用函数</h1><h2 id="本章专题脉络"><a href="#本章专题脉络" class="headerlink" title="本章专题脉络"></a>本章专题脉络</h2><img src="/2025/02/01/%E6%8A%80%E6%9C%AF%E6%A0%88/C/%E7%AC%AC08%E7%AB%A0_C%E8%AF%AD%E8%A8%80%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0/第8章_C语言常用函数.png" srcset="/img/loading.gif" lazyload style="zoom: 50%;">
<!--

<img src="第08章_C语言常用函数\第8章_C语言常用函数.png" srcset="/img/loading.gif" lazyload style="zoom: 50%;" />

<p>–&gt;</p>
<h2 id="1、字符串相关函数"><a href="#1、字符串相关函数" class="headerlink" title="1、字符串相关函数"></a>1、字符串相关函数</h2><h3 id="1-1-字符串的表示方式"><a href="#1-1-字符串的表示方式" class="headerlink" title="1.1 字符串的表示方式"></a>1.1 字符串的表示方式</h3><p>C 语言没有单独的字符串类型，字符串被当作字符数组，即 char 类型的数组。表示方式如下：</p>
<p><strong>方式1：</strong></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">char</span> str[] = <span class="hljs-string">&quot;hello&quot;</span>;<br></code></pre></td></tr></table></figure>

<p><strong>方式2：</strong></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">char</span> *str = <span class="hljs-string">&quot;hello&quot;</span>;<br></code></pre></td></tr></table></figure>

<h3 id="1-2-两种方式的区别"><a href="#1-2-两种方式的区别" class="headerlink" title="1.2 两种方式的区别"></a>1.2 两种方式的区别</h3><p>字符指针和字符数组，这两种声明字符串变量的写法基本是等价的，但是也有区别。</p>
<p><strong>区别1：</strong>指针指向的字符串，在 C 语言内部被当作常量，不能修改字符串本身。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">char</span>* str = <span class="hljs-string">&quot;hello!&quot;</span>;<br>str[<span class="hljs-number">0</span>] = <span class="hljs-string">&#x27;z&#x27;</span>; <span class="hljs-comment">// 报错</span><br></code></pre></td></tr></table></figure>

<p>如果使用数组声明字符串变量，就没有这个问题，可以修改数组的任意成员。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">char</span> str[] = <span class="hljs-string">&quot;hello&quot;</span>;<br>str[<span class="hljs-number">0</span>] = <span class="hljs-string">&#x27;z&#x27;</span>; <span class="hljs-comment">// 不报错</span><br></code></pre></td></tr></table></figure>

<p>为什么字符串声明为指针时不能修改，声明为数组时就可以修改？</p>
<p>因为系统会将字符串的字面量保存在内存的常量区，这个区域是不允许用户修改的。声明为指针时，指针变量存储的值是一个指向常量区的内存地址，因此用户不能通过这个地址去修改常量区。但是，声明为数组时，编译器会给数组单独分配一段内存，字符串字面量会被编译器解释成字符数组，逐个字符写入这段新分配的内存之中，而这段新内存是允许修改的。</p>
<p>测试代码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br><br>    <span class="hljs-type">char</span> str1[] = <span class="hljs-string">&quot;hello&quot;</span>; <span class="hljs-comment">//新开辟的空间，保存数组中的数据</span><br>    <span class="hljs-type">char</span> str2[] = <span class="hljs-string">&quot;hello&quot;</span>; <span class="hljs-comment">//新开辟的空间，保存数组中的数据</span><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%p\n&quot;</span>,str1); <span class="hljs-comment">//000000f4a93ff81a</span><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%p\n&quot;</span>,str2); <span class="hljs-comment">//000000f4a93ff814</span><br><br>    <span class="hljs-type">char</span> * str3 = <span class="hljs-string">&quot;hello&quot;</span>; <br>    <span class="hljs-type">char</span> * str4 = <span class="hljs-string">&quot;hello&quot;</span>; <span class="hljs-comment">//与前一个str3的数据是共享的，存在于常量区</span><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%p\n&quot;</span>,str3); <span class="hljs-comment">//00007ff6842ca004</span><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%p\n&quot;</span>,str4); <span class="hljs-comment">//00007ff6842ca004</span><br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>区别2：</strong>指针变量可以指向其它字符串。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">char</span>* s = <span class="hljs-string">&quot;hello&quot;</span>;<br>s = <span class="hljs-string">&quot;world&quot;</span>;<br></code></pre></td></tr></table></figure>

<p>但是，字符数组变量不能指向另一个字符串。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">char</span> s[] = <span class="hljs-string">&quot;hello&quot;</span>;<br>s = <span class="hljs-string">&quot;world&quot;</span>; <span class="hljs-comment">// 报错</span><br></code></pre></td></tr></table></figure>

<p>字符数组的数组名，总是指向初始化时的字符串地址，不能修改。所以，声明字符数组后，不能直接用字符串赋值。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">char</span> s[<span class="hljs-number">10</span>];<br>s = <span class="hljs-string">&quot;abc&quot;</span>; <span class="hljs-comment">// 错误</span><br></code></pre></td></tr></table></figure>

<p>为什么数组变量不能赋值为另一个数组？</p>
<p>因为数组变量所在的地址无法改变，或者说，编译器一旦为数组变量分配地址后，这个地址就绑定这个数组变量了，这种绑定关系是不变的，即不能用赋值运算符为它重新赋值。</p>
<p>想要重新赋值，必须使用 C 语言原生提供的 strcpy() 函数，通过字符串拷贝完成赋值。这样做以后，数组变量的地址还是不变的，即 strcpy() 只是在原地址写入新的字符串，而不是让数组变量指向新的地址。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">char</span> s[<span class="hljs-number">10</span>];<br><span class="hljs-built_in">strcpy</span>(s, <span class="hljs-string">&quot;abc&quot;</span>);<br></code></pre></td></tr></table></figure>



<blockquote>
<p>【武汉科技大学2019研】下面各语句中，能正确进行字符串操作的语句是（　　）。<br>A．char a[10]＝{‘A’，’B’，’C’，’D’，’\0’}；<br>B．char a[10]；  a＝”ABCDE”；<br>C．char *p；  *p＝”ABCDE”；<br>D．char *s； scanf（”%s”， s）；</p>
<p>【答案】A</p>
<p>【解析】B项中，字符数组的数组名指向数组的首元素地址，初始化后不可再被更改；CD两项中的字符指针在定义时均没有进行初始化，对其赋值是非法的，答案选A。</p>
</blockquote>
<blockquote>
<p> 【北京航空航天大学2018研】对于以下C程序，其正确的是（　　）。</p>
 <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;  <br>  <span class="hljs-type">char</span> str1[]=<span class="hljs-string">&quot;Hello&quot;</span>;  <br>  <span class="hljs-type">char</span> str2[]=<span class="hljs-string">&quot;Hello&quot;</span>;  <br>  <span class="hljs-keyword">if</span>(str1==str2)    <br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Equal\n&quot;</span>);  <br>  <span class="hljs-keyword">else</span>    <br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Unequal\n&quot;</span>);  <br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125; <br></code></pre></td></tr></table></figure>

<p> A．Unequal<br> B．Equal<br> C．该程序无法通过编译<br> D．该程序运行时出错</p>
<p> 【答案】A</p>
<p> 【解析】首先该程序符合语法规则，因此不会编译时产生错误，其次字符数组str1和str2都为指针常量，将他们直接用关系运算符进行比较肯定是不相等的，但是它们所指的字符串是相等的，因此最后输出Unequal。</p>
</blockquote>
<h3 id="1-2-字符串常用函数"><a href="#1-2-字符串常用函数" class="headerlink" title="1.2 字符串常用函数"></a>1.2 字符串常用函数</h3><p>这里的字符串处理函数，都属于<strong>库函数</strong>。库函数并非C语言本身的组成部分，而是C语言编译系统为方便用户使用而提供的公共函数。不同的编译系统提供的函数数量和函数名、函数功能都不尽相同，使用时要小心，必要时查一下<strong>库函数手册</strong>。</p>
<p>在使用字符串处理函数时，应当在程序文件的开头用<code>#include &lt;string.h&gt;</code>把 string.h 文件包含到本文件中。</p>
<h4 id="strlen"><a href="#strlen" class="headerlink" title="strlen()"></a>strlen()</h4><p>作用：返回字符串的字节长度，不包括末尾的空字符 ‘\0’ 。</p>
<p>函数原型：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// string.h</span><br><span class="hljs-comment">//参数是字符串变量，返回的是 size_t 类型的无符号整数,一般当做int类型处理。</span><br><span class="hljs-type">size_t</span> <span class="hljs-title function_">strlen</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span>* s)</span>;<br></code></pre></td></tr></table></figure>

<p>举例：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span>    <span class="hljs-comment">//需要加载此头文件</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">char</span> str[<span class="hljs-number">10</span>] = <span class="hljs-string">&quot;China&quot;</span>;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, <span class="hljs-built_in">strlen</span>(str));     <span class="hljs-comment">//5</span><br><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, <span class="hljs-built_in">strlen</span>(<span class="hljs-string">&quot;China&quot;</span>)); <span class="hljs-comment">//5</span><br>    <br>    <span class="hljs-comment">//区别于sizeof(),是两个不同的概念</span><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, <span class="hljs-keyword">sizeof</span>(str));        <span class="hljs-comment">//10</span><br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="strcpy"><a href="#strcpy" class="headerlink" title="strcpy()"></a>strcpy()</h4><p><strong>strcpy(字符数组1, 字符数组2)</strong> ：字符串的复制，不能使用赋值运算符，直接将字符数组2的字符串复制到字符数组1中。</p>
<p>函数原型：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// string.h</span><br><span class="hljs-built_in">strcpy</span>(<span class="hljs-type">char</span> dest[], <span class="hljs-type">const</span> <span class="hljs-type">char</span> source[])<br></code></pre></td></tr></table></figure>

<p>使用此函数前，如何复制字符串呢？</p>
<p>一方面，下面两种字符串的复制写法，都是错的。因为数组的变量名是一个固定的地址，不能修改，使其指向另一个地址。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">char</span> str1[<span class="hljs-number">10</span>];<br><span class="hljs-type">char</span> str2[<span class="hljs-number">10</span>];<br>str1 = <span class="hljs-string">&quot;abc&quot;</span>; <span class="hljs-comment">// 报错</span><br>str2 = str1;  <span class="hljs-comment">// 报错</span><br></code></pre></td></tr></table></figure>

<p>另一方面，如果是字符指针，赋值运算符（ &#x3D; ）只是将一个指针的地址复制给另一个指针，而不是复制字符串。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">char</span>* str1;<br><span class="hljs-type">char</span>* str2;<br><br>str1 = <span class="hljs-string">&quot;abc&quot;</span>;<br>str2 = str1;<br></code></pre></td></tr></table></figure>

<p>此时，可以使用 strcpy(字符数组1,字符数组2) 函数，用于将一个字符串的内容复制到另一个字符串（<strong>前提</strong>：字符数组1的长度不小于字符数组2的长度，否则会溢出）。</p>
<p>举例：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">char</span> str1[<span class="hljs-number">10</span>], str2[] = <span class="hljs-string">&quot;China&quot;</span>;<br>    <span class="hljs-built_in">strcpy</span>(str1, str2);<br>    <br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s\n&quot;</span>,str1);<br><br>    <span class="hljs-comment">//或</span><br><span class="hljs-comment">//    strcpy(str1, &quot;China&quot;); //参数2，也可以是一个字符串常量</span><br><span class="hljs-comment">//    printf(&quot;%s\n&quot;,str1);</span><br>    <br>    <span class="hljs-comment">//进一步</span><br>    str1[<span class="hljs-number">0</span>] = <span class="hljs-string">&#x27;A&#x27;</span>;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s\n&quot;</span>,str1); <span class="hljs-comment">//Ahina</span><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s\n&quot;</span>,str2); <span class="hljs-comment">//China</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>思考：如下程序的输出结果</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br><br>    <span class="hljs-type">char</span> str1[<span class="hljs-number">10</span>] = <span class="hljs-string">&quot;abcde1234&quot;</span>, str2[] = <span class="hljs-string">&quot;China&quot;</span>;<br>    <span class="hljs-built_in">strcpy</span>(str1, str2);<br><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s\n&quot;</span>,str1); <span class="hljs-comment">//</span><br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>;i &lt; <span class="hljs-number">10</span>;i++)&#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>,str1[i]); <span class="hljs-comment">//</span><br>    &#125;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">China</span><br><span class="hljs-attribute">China</span> <span class="hljs-number">2345</span><br></code></pre></td></tr></table></figure>

<p>复制时将字符串2和其后的′\0′一起复制到字符数组1中，取代字符数组1中前面的字符，未被取代的字符保持原有内容。</p>
<h4 id="strncpy"><a href="#strncpy" class="headerlink" title="strncpy()"></a>strncpy()</h4><p>作用：将字符串2中前面n个字符复制到字符数组1中去。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-built_in">strncpy</span>(str1, str2, n);<br></code></pre></td></tr></table></figure>

<p>将str2中最前面n个字符复制到str1中，取代str1中原有的最前面n个字符。但复制的字符个数n不应多于str1中原有的字符（不包括′\0′）。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br><br>    <span class="hljs-type">char</span> s1[<span class="hljs-number">40</span>] = <span class="hljs-string">&quot;1234567890&quot;</span>;<br>    <span class="hljs-type">char</span> s2[<span class="hljs-number">12</span>] = <span class="hljs-string">&quot;helloworld&quot;</span>;<br>    <span class="hljs-built_in">strncpy</span>(s1, s2, <span class="hljs-number">5</span>);<br><span class="hljs-comment">//    s1[5] = &#x27;\0&#x27;;  //测试这行代码添加的必要性</span><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s\n&quot;</span>, s1); <span class="hljs-comment">// </span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="strcat"><a href="#strcat" class="headerlink" title="strcat()"></a>strcat()</h4><p>**strcat(字符数组1, 字符数组2)**：把两个字符数组中的字符串连接起来，把字符串2接到字符串1的后面，结果放在字符数组1中，函数调用后得到一个函数值——字符数组1的地址。</p>
<p>函数原型：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">char</span>* <span class="hljs-title function_">strcat</span><span class="hljs-params">(<span class="hljs-type">char</span>* s1, <span class="hljs-type">const</span> <span class="hljs-type">char</span>* s2)</span>;<br></code></pre></td></tr></table></figure>

<p>说明：</p>
<p>1、字符数组1必须足够大，以便容纳连接后的新字符串。</p>
<p>2、连接前两个字符串的后面都有′\0′，连接时将字符串1后面的′\0′取消，只在新串最后保留′\0′。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">char</span> str1[<span class="hljs-number">30</span>] = &#123;<span class="hljs-string">&quot;People′s Republic of &quot;</span>&#125;;<br>    <span class="hljs-type">char</span> str2[] = &#123;<span class="hljs-string">&quot;China&quot;</span>&#125;;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s\n&quot;</span>, <span class="hljs-built_in">strcat</span>(str1, str2)); <span class="hljs-comment">//People′s Republic of China</span><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s\n&quot;</span>, str1);  <span class="hljs-comment">//People′s Republic of China</span><br><br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="strncat"><a href="#strncat" class="headerlink" title="strncat()"></a>strncat()</h4><p>作用：将字符串2中前面n个字符连接到字符数组1中去。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-built_in">strncat</span>(str1, str2, n);<br></code></pre></td></tr></table></figure>

<p>strncat() 总是会在拼接结果的结尾，自动添加空字符′\0′ ，所以第三个参数的最大值，应该是 str1 的变量长度减去 str1 的字符串长度，再减去 1 。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br><br>    <span class="hljs-type">char</span> s1[<span class="hljs-number">10</span>] = <span class="hljs-string">&quot;Hello&quot;</span>;<br>    <span class="hljs-type">char</span> s2[<span class="hljs-number">8</span>] = <span class="hljs-string">&quot;World&quot;</span>;<br>    <span class="hljs-built_in">strncat</span>(s1, s2, <span class="hljs-number">3</span>);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s\n&quot;</span>, s1);  <span class="hljs-comment">//HelloWor</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="strcmp"><a href="#strcmp" class="headerlink" title="strcmp()"></a>strcmp()</h4><p>函数原型：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">strcmp</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span>* s1, <span class="hljs-type">const</span> <span class="hljs-type">char</span>* s2)</span>;<br></code></pre></td></tr></table></figure>

<p>**strcmp(字符串1, 字符串2)**：比较字符串1和字符串2。</p>
<p>字符串比较的规则是：将两个字符串自左至右逐个字符相比(按ASCII码值大小比较)，直到出现不同的字符或遇到′\0′为止。</p>
<p>(1) 如全部字符相同，则认为两个字符串相等。返回值为0</p>
<p>(2) 若出现不相同的字符，如果返回值为正数，则字符串1大；反之，返回值为负数，则字符串2大。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">char</span> *str1 = <span class="hljs-string">&quot;abxy&quot;</span>;<br>    <span class="hljs-type">char</span> *str2 = <span class="hljs-string">&quot;abmn&quot;</span>;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>,<span class="hljs-built_in">strcmp</span>(str1, str2));  <span class="hljs-comment">// 1</span><br><br>    <span class="hljs-type">int</span> compare1 = <span class="hljs-built_in">strcmp</span>(<span class="hljs-string">&quot;China&quot;</span>, <span class="hljs-string">&quot;Korea&quot;</span>);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>,compare1);  <span class="hljs-comment">// -1</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="strlwr-strupr"><a href="#strlwr-strupr" class="headerlink" title="strlwr()&#x2F;strupr()"></a>strlwr()&#x2F;strupr()</h4><p>**strlwr(字符串)**：将字符串中大写字母换成小写字母。</p>
<p>**strupr(字符串)**：将字符串中小写字母换成大写字母。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br><br>    <span class="hljs-type">char</span> str[] = <span class="hljs-string">&quot;HelloWorld&quot;</span>;<br>    strlwr(str);<br>    <span class="hljs-built_in">puts</span>(str); <span class="hljs-comment">//helloworld</span><br><br>    strupr(str);<br>    <span class="hljs-built_in">puts</span>(str); <span class="hljs-comment">//HELLOWORLD</span><br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="1-3-基本数据类型和字符串的转换"><a href="#1-3-基本数据类型和字符串的转换" class="headerlink" title="1.3 基本数据类型和字符串的转换"></a>1.3 基本数据类型和字符串的转换</h3><p>在程序开发中，我们经常需要将基本数据类型转成字符串类型(即 char数组 )。或者将字符串类型转成基本数据类型。</p>
<h4 id="基本数据类型-字符串"><a href="#基本数据类型-字符串" class="headerlink" title="基本数据类型 -&gt; 字符串"></a>基本数据类型 -&gt; 字符串</h4><p>sprintf()函数可以将其他数据类型转换成字符串类型。此函数声明在<code>stdio.h</code>头文件中。</p>
<p>sprintf()和平时我们常用的printf()函数的功能相似，只是sprintf()函数输出到字符串中，而printf()函数输出到屏幕上。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">char</span> str1[<span class="hljs-number">20</span>]; <span class="hljs-comment">//字符数组，即字符串</span><br>    <span class="hljs-type">char</span> str2[<span class="hljs-number">20</span>];<br>    <span class="hljs-type">char</span> str3[<span class="hljs-number">20</span>];<br>    <span class="hljs-type">int</span> a = <span class="hljs-number">111</span>, b = <span class="hljs-number">222</span>;<br>    <span class="hljs-type">char</span> c = <span class="hljs-string">&#x27;a&#x27;</span>;<br>    <span class="hljs-type">double</span> d = <span class="hljs-number">333.444</span>;<br><br><br>    <span class="hljs-built_in">sprintf</span>(str1, <span class="hljs-string">&quot;%d %d&quot;</span>, a, b);<br>    <span class="hljs-built_in">sprintf</span>(str2, <span class="hljs-string">&quot;%d%c&quot;</span>, a, c);<br>    <span class="hljs-built_in">sprintf</span>(str3, <span class="hljs-string">&quot;%.5f&quot;</span>, d);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;str1=%s\n&quot;</span>, str1); <span class="hljs-comment">//111 222</span><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;str2=%s\n&quot;</span>, str2); <span class="hljs-comment">//111a</span><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;str3=%s\n&quot;</span>, str3); <span class="hljs-comment">//333.44400</span><br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="字符串-基本数据类型"><a href="#字符串-基本数据类型" class="headerlink" title="字符串 -&gt; 基本数据类型"></a>字符串 -&gt; 基本数据类型</h4><p>调用头文件<code> &lt;stdlib.h&gt;</code> 的函数<code>atoi()</code> 或 <code>atof()</code> 即可。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">char</span> str1[<span class="hljs-number">10</span>] = <span class="hljs-string">&quot;123456&quot;</span>;<br>    <span class="hljs-type">char</span> str2[<span class="hljs-number">4</span>] = <span class="hljs-string">&quot;111&quot;</span>;<br>    <span class="hljs-type">char</span> str3[<span class="hljs-number">10</span>] = <span class="hljs-string">&quot;12.67423&quot;</span>;<br>    <span class="hljs-type">char</span> str4[<span class="hljs-number">2</span>] = <span class="hljs-string">&quot;a&quot;</span>;<br><br>    <span class="hljs-type">int</span> i = atoi(str1);<br>    <span class="hljs-type">int</span> j = atof(str1);<br>    <span class="hljs-type">short</span> s = atoi(str2);<br>    <span class="hljs-type">double</span> d = atof(str3);<br>    <span class="hljs-type">char</span> c = str4[<span class="hljs-number">0</span>];<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;i=%d,j=%d,s=%d,d=%lf,c=%c&quot;</span>, i, j, s, d, c);<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>



<h2 id="2、日期和时间相关函数"><a href="#2、日期和时间相关函数" class="headerlink" title="2、日期和时间相关函数"></a>2、日期和时间相关函数</h2><p>在编程中，程序员会经常使用到日期相关的函数，比如：统计某段代码执行花费的时间等等。头文件是 <code>&lt;time.h&gt;</code>。</p>
<p>举例说明：</p>
<ul>
<li>返回一个值，即格林尼治时间1970年1月1日00:00:00到当前时刻的时长，时长单位是秒。</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">time_t</span> <span class="hljs-title function_">time</span><span class="hljs-params">(<span class="hljs-type">time_t</span> *t)</span><br></code></pre></td></tr></table></figure>

<ul>
<li>获取当前时间，返回一个表示当地时间的字符串(当地时间是基于参数timer的)。</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">char</span> *<span class="hljs-title function_">ctime</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">time_t</span> *timer)</span><br></code></pre></td></tr></table></figure>

<ul>
<li>计算time1和time2之间相差的秒数（time1-time2）</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">double</span> <span class="hljs-title function_">difftime</span><span class="hljs-params">(<span class="hljs-type">time_t</span> time1, <span class="hljs-type">time_t</span> time2)</span><br></code></pre></td></tr></table></figure>

<p>举例：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;time.h&gt;</span> <span class="hljs-comment">//该头文件中，声明日期和时间相关的函数</span></span><br><br><span class="hljs-comment">//  运行test函数，看看执行花费时间</span><br><span class="hljs-type">void</span> <span class="hljs-title function_">test</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">int</span> i = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">int</span> sum = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">int</span> j = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10000000</span>; i++) &#123;<br>        sum = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> (j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">100</span>; j++) &#123;<br>            sum += j;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;程序启动...\n&quot;</span>);<br><br>    <span class="hljs-type">time_t</span> <span class="hljs-type">start_t</span>;<br>    <span class="hljs-comment">//先得到执行test前的时间</span><br>    time(&amp;<span class="hljs-type">start_t</span>); <span class="hljs-comment">//获取当前时间</span><br><br>    test(); <span class="hljs-comment">//执行test</span><br><br>    <span class="hljs-type">time_t</span> <span class="hljs-type">end_t</span>;<br>    <span class="hljs-comment">//再得到执行test后的时间</span><br>    time(&amp;<span class="hljs-type">end_t</span>); <span class="hljs-comment">//获取当前时间</span><br><br>    <span class="hljs-type">double</span> <span class="hljs-type">diff_t</span>; <span class="hljs-comment">//存放时间差</span><br>    <span class="hljs-type">diff_t</span> = difftime(<span class="hljs-type">end_t</span>, <span class="hljs-type">start_t</span>); <span class="hljs-comment">//时间差，按秒 ent_t - start_t</span><br><br><br>    <span class="hljs-comment">//然后得到两个时间差就是耗用的时间</span><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>,<span class="hljs-type">start_t</span>); <span class="hljs-comment">//1697026306</span><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>,<span class="hljs-type">end_t</span>); <span class="hljs-comment">//1697026308</span><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;执行test()函数 耗用了%.2f 秒\n&quot;</span>, <span class="hljs-type">diff_t</span>); <span class="hljs-comment">//执行test()函数 耗用了2.00 秒</span><br><br>    <span class="hljs-comment">//获取时间对应的字符串的表示</span><br>    <span class="hljs-type">char</span> * startTimeStr = ctime(&amp;<span class="hljs-type">start_t</span>);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s\n&quot;</span>,startTimeStr); <span class="hljs-comment">//Wed Oct 11 20:11:48 2023</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>



<h2 id="3、数学运算相关的函数"><a href="#3、数学运算相关的函数" class="headerlink" title="3、数学运算相关的函数"></a>3、数学运算相关的函数</h2><p><code>math.h</code>头文件定义了各种数学函数。在这个库中所有可用的功能都带有一个 double 类型的参数，且都返回 double 类型的结果。</p>
<ul>
<li>double exp(double x) ：返回 e 的 x 次幂的值。</li>
<li>double log(double x) ：返回 x 的自然对数（基数为 e 的对数）</li>
<li>double pow(double x, double y) ：返回 x 的 y 次幂。</li>
<li>double sqrt(double x) ：返回 x 的平方根。</li>
<li>double fabs(double x) ：返回 x 的绝对值。</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;math.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">double</span> d1 = <span class="hljs-built_in">pow</span>(<span class="hljs-number">2.0</span>, <span class="hljs-number">3.0</span>);<br>    <span class="hljs-type">double</span> d2 = <span class="hljs-built_in">sqrt</span>(<span class="hljs-number">5.0</span>);<br><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;d1=%.2f\n&quot;</span>, d1); <span class="hljs-comment">//d1=8.00</span><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;d2=%f\n&quot;</span>, d2);   <span class="hljs-comment">//d2=2.236068</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>



<h2 id="4、内存管理相关函数"><a href="#4、内存管理相关函数" class="headerlink" title="4、内存管理相关函数"></a>4、内存管理相关函数</h2><h3 id="4-1-C程序的内存分配"><a href="#4-1-C程序的内存分配" class="headerlink" title="4.1 C程序的内存分配"></a>4.1 C程序的内存分配</h3><p><strong>C程序中，不同数据在内存中分配说明：</strong></p>
<ol>
<li><p>全局变量和静态局部变量——内存中的静态存储区&#x2F;全局区</p>
</li>
<li><p>非静态的局部变量——内存中的动态存储区：stack 栈</p>
</li>
<li><p>临时使用的数据——建立动态内存分配区域，需要时随时开辟，不需要时及时释放——heap 堆</p>
</li>
<li><p>根据需要<code>向系统申请</code>所需大小的空间，由于未在声明部分定义其为变量或者数组，不能通过变量名或者数组名来引用这些数据，只能通过<strong>指针</strong>来引用）</p>
</li>
</ol>
<p><img src="/image-20231011215429378.png" srcset="/img/loading.gif" lazyload></p>
<!--

![image-20231011215429378.png](第08章_C语言常用函数\image-20231011215429378.png)

-->

<h3 id="4-2-void-指针-无类型指针"><a href="#4-2-void-指针-无类型指针" class="headerlink" title="4.2 void 指针(无类型指针)"></a>4.2 void 指针(无类型指针)</h3><ul>
<li><p>每一块内存都有地址，通过指针变量可以获取指定地址的内存块。</p>
</li>
<li><p>指针变量必须有类型，否则编译器无法知道如何解读内存块保存的二进制数据。但是，向系统请求内存的时候，有时不确定会有什么样的数据写入内存，需要先获得内存块，稍后再确定写入的数据类型。</p>
</li>
</ul>
<p>综上，为了满足这种需求，C 语言提供了一种不定类型的指针，叫做 void 指针。它只有内存块的<code>地址信息</code>，<code>没有类型信息</code>，等到使用该块内存的时候，再向编译器补充说明，里面的数据类型是什么。</p>
<p>此外，由于void 指针等同于无类型指针(typeless pointer)，可以<code>指向任意类型</code>的数据，但是<code>不能解读数据</code>。void 指针与其他所有类型指针之间是<code>互相转换关系</code>，任一类型的指针都可以转为 void 指针，而 void 指针也可以转为任一类型的指针。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> x = <span class="hljs-number">10</span>;<br><span class="hljs-type">void</span> *p = &amp;x; <span class="hljs-comment">// 整数指针转为 void 指针</span><br><span class="hljs-type">int</span> *q = p; <span class="hljs-comment">// void 指针转为整数指针</span><br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">char</span> a = <span class="hljs-string">&#x27;X&#x27;</span>;<br><span class="hljs-type">void</span>* p = &amp;a;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c\n&quot;</span>, *p); <span class="hljs-comment">// 报错</span><br></code></pre></td></tr></table></figure>

<p>由于不知道 void 指针指向什么类型的值，所以不能用 * 运算符取出它指向的值。</p>
<blockquote>
<p>void 指针的重要之处在于，很多内存相关函数的返回值就是 void 指针。</p>
</blockquote>
<h3 id="4-3-内存动态分配函数"><a href="#4-3-内存动态分配函数" class="headerlink" title="4.3 内存动态分配函数"></a>4.3 内存动态分配函数</h3><p>头文件<code> &lt;stdlib.h&gt;</code>声明了四个关于内存动态分配的函数。<strong>所谓动态分配内存，就是按需分配，申请才能获得。</strong></p>
<h4 id="掌握：malloc"><a href="#掌握：malloc" class="headerlink" title="掌握：malloc()"></a>掌握：malloc()</h4><p>函数原型：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">void</span> *<span class="hljs-title function_">malloc</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> size)</span>;  <span class="hljs-comment">//size的类型为无符号整型</span><br></code></pre></td></tr></table></figure>

<p>作用：在内存的<code>动态存储区(堆区)</code>中分配一个<code>长度为size</code>的<code>连续空间</code>。并将该空间的首地址作为函数值返回，即此函数是一个指针函数。</p>
<p>由于返回的指针的基类型为 void，应通过显式类型转换后才能存入其他基类型的指针变量，否则会有警告。如果分配不成功，返回空指针（NULL）。</p>
<p>举例1： </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> *p;<br>p=(<span class="hljs-type">int</span> *)<span class="hljs-built_in">malloc</span>(<span class="hljs-keyword">sizeof</span>(<span class="hljs-type">int</span>));<br></code></pre></td></tr></table></figure>

<p>举例2：动态申请数组空间</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> *p;<br>p = (<span class="hljs-type">int</span> *)<span class="hljs-built_in">malloc</span>(n * <span class="hljs-keyword">sizeof</span>(<span class="hljs-type">int</span>));<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i++)<br>  p[i] = i * <span class="hljs-number">5</span>;<br></code></pre></td></tr></table></figure>

<p>得到一个元素类型为int型，长度为n的数组。取元素方式与之前相同，如获取第2个元素：p[1]。</p>
<p>举例3：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">node</span> *<span class="hljs-title">p</span>;</span><br>p = (<span class="hljs-keyword">struct</span> node *) <span class="hljs-built_in">malloc</span>(<span class="hljs-keyword">sizeof</span>(<span class="hljs-keyword">struct</span> node));  <span class="hljs-comment">//(struct node*)为强制类型转换</span><br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">BTNode</span>&#123;</span><br>	<span class="hljs-type">int</span> data;<br>	<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">BTNode</span> *<span class="hljs-title">lchild</span>;</span><br>	<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">BTNode</span> *<span class="hljs-title">rchild</span>;</span><br>&#125;BTNode;<br><br><span class="hljs-comment">//声明二叉树结点方式1</span><br>BTNode bt1;<br><span class="hljs-comment">//声明二叉树结点方式2：需熟练掌握</span><br>BTNode *bt2;<br>bt2 = (BTNode*)<span class="hljs-built_in">malloc</span>(<span class="hljs-keyword">sizeof</span>(BTNode));<br></code></pre></td></tr></table></figure>

<blockquote>
<p>考研数据结构中所有类型结点的内存分配都可以用函数malloc()来完成，模式固定，容易记忆。</p>
</blockquote>
<p>方式2中的BT是指针型变量，还可以指向其它节点。而方式1中的BT则不行。此外，调用结构体成员时，</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">//针对于方式1：结构体变量取成员，用&quot;.&quot;</span><br><span class="hljs-type">int</span> x = bt1.data;<br><br><span class="hljs-comment">//针对于方式2：指向结构体的指针取成员，用&quot;-&gt;&quot;</span><br><span class="hljs-type">int</span> x = bt2-&gt;data;<br><span class="hljs-type">int</span> x = (*bt2).data;<span class="hljs-comment">//以前的写法</span><br></code></pre></td></tr></table></figure>

<p><strong>关于返回值为NULL：</strong></p>
<p>malloc() 分配内存有可能分配失败，这时返回常量 NULL。Null 的值为0，是一个无法读写的内存地址，可以理解成一个不指向任何地方的指针。它在包括 <code>stdlib.h</code> 等多个头文件里面都有定义，所以只要可以使用 malloc() ，就可以使用 NULL 。由于存在分配失败的可能，所以最好在使用 malloc() 之后检查一下，是否分配成功。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span>* p = <span class="hljs-built_in">malloc</span>(<span class="hljs-keyword">sizeof</span>(<span class="hljs-type">int</span>));<br><span class="hljs-keyword">if</span> (p == <span class="hljs-literal">NULL</span>) &#123; <span class="hljs-comment">// 内存分配失败</span><br>  <br>&#125;<br><span class="hljs-comment">// 或</span><br><span class="hljs-keyword">if</span> (p != <span class="hljs-literal">NULL</span>) &#123;<br>  <span class="hljs-comment">//...</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>上面示例中，通过判断返回的指针 p 是否为 NULL ，确定 malloc() 是否分配成功。</p>
<h4 id="了解：calloc"><a href="#了解：calloc" class="headerlink" title="了解：calloc()"></a>了解：calloc()</h4><p>函数原型：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">void</span> *<span class="hljs-title function_">calloc</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> n,<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> size)</span>;<br></code></pre></td></tr></table></figure>

<p>作用：在内存的**动态存储区(堆区)*<em>中分配n个，单位长度为size的连续空间，这个空间一般比较大，总共占用n</em>size 个字节。并将该空间的首地址作为函数的返回值。如果函数没有成功执行，返回NULL。</p>
<p>calloc()函数适合为<code>一维数组</code>开辟动态存储空间，n为数组元素个数，每个元素长度为size。</p>
<p>举例：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> *p;<br>p = (<span class="hljs-type">int</span> *)<span class="hljs-built_in">calloc</span>(<span class="hljs-number">10</span>,<span class="hljs-keyword">sizeof</span>(<span class="hljs-type">int</span>)); <span class="hljs-comment">//开辟空间的同时，其内容初始化为零</span><br><br><span class="hljs-comment">//等同于</span><br><span class="hljs-type">int</span>* p;<br>p = (<span class="hljs-type">int</span> *)<span class="hljs-built_in">malloc</span>(<span class="hljs-number">10</span> * <span class="hljs-keyword">sizeof</span>(<span class="hljs-type">int</span>));<br><span class="hljs-built_in">memset</span>(p, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(<span class="hljs-type">int</span>) * <span class="hljs-number">10</span>);<br></code></pre></td></tr></table></figure>

<p>上面示例中， calloc() 相当于 malloc() + memset() 。</p>
<h4 id="了解：realloc"><a href="#了解：realloc" class="headerlink" title="了解：realloc()"></a>了解：realloc()</h4><p>函数原型： </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">void</span> *<span class="hljs-title function_">realloc</span><span class="hljs-params">(<span class="hljs-type">void</span>* p, <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> size)</span><br></code></pre></td></tr></table></figure>

<p>作用：重新分配malloc()或calloc()函数获得的动态空间大小，即调整大小的内存空间。将先前开辟的内存块的指针p指向的动态空间大小改变为size，单位字节。返回值是一个全新的地址（数据也会自动复制过去），也可能返回跟原来一样的地址。分配失败返回NULL。</p>
<ul>
<li>realloc() 优先在原有内存块上进行缩减，尽量不移动数据，所以通常是返回原先的地址。</li>
<li>如果新内存块小于原来的大小，则丢弃超出的部分；如果大于原来的大小，则不对新增的部分进行初始化（程序员可以自动调用 memset() ）。</li>
</ul>
<p>举例1：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span>* b;<br>b = (<span class="hljs-type">int</span> *)<span class="hljs-built_in">malloc</span>(<span class="hljs-keyword">sizeof</span>(<span class="hljs-type">int</span>) * <span class="hljs-number">10</span>);<br>b = (<span class="hljs-type">int</span> *)<span class="hljs-built_in">realloc</span>(b, <span class="hljs-keyword">sizeof</span>(<span class="hljs-type">int</span>) * <span class="hljs-number">2000</span>);<br></code></pre></td></tr></table></figure>

<p>指针 b 原来指向10个成员的整数数组，使用 realloc() 调整为2000个成员的数组。</p>
<p>举例2：动态栈入栈时，判断是否需要扩容</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">push</span><span class="hljs-params">(SqStack &amp;S, ElemType e)</span> &#123;<br>    <span class="hljs-keyword">if</span> (S.top - S.bottom &gt;= S.stacksize) &#123;               <span class="hljs-comment">//栈满，追加存储空间</span><br>        S.bottom = (ElemType *) <span class="hljs-built_in">realloc</span>(S.bottom,(STACKINCREMENT + S.stacksize) * <span class="hljs-keyword">sizeof</span>(ElemType));<br>        <span class="hljs-keyword">if</span> (!S.bottom) <span class="hljs-comment">//if(S.bottom == NULL)</span><br>            <span class="hljs-keyword">return</span> FALSE;       <span class="hljs-comment">//空间分配失败</span><br>        S.top = S.bottom + S.stacksize;<br>        S.stacksize += STACKINCREMENT;<br>    &#125;<br>    *S.top = e;<br>    S.top++;     <span class="hljs-comment">// 栈顶指针加1</span><br>    <span class="hljs-keyword">return</span> TRUE;<br>&#125;<br></code></pre></td></tr></table></figure>



<h4 id="掌握：free"><a href="#掌握：free" class="headerlink" title="掌握：free()"></a>掌握：free()</h4><p>函数原型：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">void</span> <span class="hljs-title function_">free</span><span class="hljs-params">(<span class="hljs-type">void</span> *p)</span>;<br></code></pre></td></tr></table></figure>

<p>函数无返回值。p是最近一次调用malloc()或calloc()函数时的返回值。</p>
<p>作用：释放指针变量p所指向的内存空间，使这部分内存能重新被其它变量使用。否则这个内存块会一直占用到程序运行结束。</p>
<p>举例：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> *p;<br>p=(<span class="hljs-type">int</span> *)<span class="hljs-built_in">malloc</span>(<span class="hljs-keyword">sizeof</span>(<span class="hljs-type">int</span>));<br>    <br><span class="hljs-comment">//...各种操作...</span><br>    <br><span class="hljs-built_in">free</span>(p); <span class="hljs-comment">//千万不要忘了使用free()释放内存！</span><br></code></pre></td></tr></table></figure>

<blockquote>
<p>注意：</p>
<p>1、指针 p 必须是经过动态分配函数 malloc 成功后返回的首地址。</p>
<p>2、分配的内存块一旦释放，就不应该再次操作已经释放的地址，也不应该再次使用 free() 对该地址释放第二次。</p>
<p>3、如果忘记调用free()函数，同时p所在的函数调用结束后p指针已经消失了，导致无法访问未回收的内存块，构成内存泄漏。</p>
</blockquote>
<h3 id="4-4-举例"><a href="#4-4-举例" class="headerlink" title="4.4 举例"></a>4.4 举例</h3><p>举例：动态创建数组，输入5个学生的成绩，另外一个函数检测成绩低于60 分的，输出不合格的成绩。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> N 5</span><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">check</span><span class="hljs-params">(<span class="hljs-type">int</span> *ptr)</span> &#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n不及格的成绩有: &quot;</span>);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++) &#123;<br>        <span class="hljs-keyword">if</span> (ptr[i] &lt; <span class="hljs-number">60</span>) &#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot; %d &quot;</span>, ptr[i]);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">int</span> *p;<br>    <span class="hljs-comment">//动态创建数组</span><br>    p = (<span class="hljs-type">int</span> *) <span class="hljs-built_in">malloc</span>(N * <span class="hljs-keyword">sizeof</span>(<span class="hljs-type">int</span>));<br><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;请输入%d个成绩：\n&quot;</span>,N);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; N; i++) &#123;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, p + i);<br>    &#125;<br>    <span class="hljs-comment">//检查不及格的学生</span><br>    check(p);<br>    <br>    <span class="hljs-built_in">free</span>(p); <span class="hljs-comment">//销毁 堆区 p 指向的空间</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>图示：</p>
<p><img src="/2025/02/01/%E6%8A%80%E6%9C%AF%E6%A0%88/C/%E7%AC%AC08%E7%AB%A0_C%E8%AF%AD%E8%A8%80%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0/image-20230822120152212.png" srcset="/img/loading.gif" lazyload></p>
<!--

![image-20230822120152212.png](第08章_C语言常用函数\image-20230822120152212.png)

-->



<h3 id="4-5-动态分配内存的基本原则"><a href="#4-5-动态分配内存的基本原则" class="headerlink" title="4.5 动态分配内存的基本原则"></a>4.5 动态分配内存的基本原则</h3><p>1）<strong>避免分配大量的小内存块。</strong>分配堆上的内存有一些系统开销，所以分配许多小的内存块比分配几个大内存块的系统开销大</p>
<p>2）<strong>仅在需要时分配内存。</strong>只要使用完堆上的内存块，就需要及时释放它，否则可能出现内存泄漏。</p>
<p>这里需要遵守原则：谁分配，谁释放。</p>
<p>3）<strong>总是确保释放以分配的内存。</strong>在编写分配内存的代码时，就要确定在代码的什么地方释放内存。</p>
<h3 id="4-6-常见的内存错误及其对策"><a href="#4-6-常见的内存错误及其对策" class="headerlink" title="4.6 常见的内存错误及其对策"></a>4.6 常见的内存错误及其对策</h3><p><strong>1）内存分配未成功，却使用了它</strong></p>
<p>新手常犯这种错误，因为他们没有意识到内存分配会不成功。</p>
<p>常用解决办法是，在使用内存之前检查指针是否为NULL。比如，如果指针p是函数的参数，那么在函数的入口处应该用<code>if(p==NULL)</code>或<code>if(p!=NULL)</code>进行防错处理。</p>
<p><strong>2）内存分配虽然成功，但是尚未初始化就引用它</strong></p>
<p>犯这种错误主要有两个起因：一是没有初始化的观念；二是误以为内存的缺省初值全为零，导致引用初值错误。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> * p = <span class="hljs-literal">NULL</span>;<br>p = (<span class="hljs-type">int</span>*)<span class="hljs-built_in">malloc</span>(<span class="hljs-keyword">sizeof</span>(<span class="hljs-type">int</span>));<br><span class="hljs-keyword">if</span> (p == <span class="hljs-literal">NULL</span>)&#123;<span class="hljs-comment">/*...*/</span>&#125;<br><span class="hljs-comment">/*初始化为0*/</span><br><span class="hljs-built_in">memset</span>(p, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(<span class="hljs-type">int</span>));<br></code></pre></td></tr></table></figure>

<p>题外话，无论用何种方式创建数组，都别忘了赋初值，即便是赋零值也不可省略，不要嫌麻烦。</p>
<p><strong>3）内存分配成功并且已经初始化，但操作时提示内存越界</strong></p>
<p>在使用数组时经常发生下标“+1”或者“-1”的操作，特别是在for循环语句中，循环次数很容易搞错，导致数组操作越界。</p>
<p>数组访问越界在运行时，它的表现是不定的，有时什么事也没有，程序一直运行（当然，某些错误结果已造成）；有时，则是程序一下子崩溃。</p>
<p><strong>4）忘记了释放内存，造成内存泄漏</strong></p>
<p>含有这种错误的函数每被调用一次就丢失一块内存。刚开始时系统的内存充足，你看不到错误。终有一次程序突然死掉，系统出现提示：内存耗尽。</p>
<p>动态内存的申请与释放必须配对，程序中<code>malloc()</code>与<code>free()</code>的使用次数一定要相同，否则肯定有错误。</p>
<p><strong>5）未正确的释放内存，造成内存泄漏</strong></p>
<p>程序中的对象调用关系过于复杂，实在难以搞清楚某个对象究竟是否已经释放了内存。此时应该重新设计数据结构，从根本上解决对象管理的混乱局面。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">getMemory</span><span class="hljs-params">(<span class="hljs-type">int</span> *p)</span> &#123;<br>    p = (<span class="hljs-type">int</span> *) <span class="hljs-built_in">malloc</span>(<span class="hljs-keyword">sizeof</span>(<span class="hljs-type">int</span>));  <span class="hljs-comment">// 在这里修改的是局部指针 p，不会影响 main 函数中的原始指针 ptr</span><br>    <span class="hljs-comment">//....</span><br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">int</span> *ptr = <span class="hljs-literal">NULL</span>;<br>    getMemory(ptr);  <span class="hljs-comment">// 将 ptr 的值传递给 getMemory，但是在函数内部修改的是 p，而不是 ptr</span><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;ptr = %d\n&quot;</span>, *ptr);  <span class="hljs-comment">// 这里的 *ptr 是未定义行为，因为 ptr 没有指向有效的内存</span><br>    <span class="hljs-built_in">free</span>(ptr);  <span class="hljs-comment">// 这里试图释放未分配的内存，会导致问题</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>在本例中，getMemory()中的p申请了新的内存，只是把 p所指的内存地址改变了，但是ptr丝毫未变。getMemory()中的p也始终没有进行内存的释放。事实上，因为没有用free释放内存，每执行一次getMemory()就会泄漏一块内存。</p>
<p><strong>6）释放了内存却继续使用它</strong></p>
<p>函数的return语句写错了，注意不要返回指向“栈内存”的“指针”或者“引用”，因为该内存在函数体结束时被自动销毁。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">long</span> *p;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">addr</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">long</span> k;<br>    k = <span class="hljs-number">0</span>;<br>    p = &amp;k;<br>&#125;<br><span class="hljs-type">void</span> <span class="hljs-title function_">port</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">long</span> i, j;<br>    j = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) &#123;<br>        (*p)--;<br>        j++;<br>    &#125;<br>&#125;<br><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    addr();<br>    port();<br>&#125;<br><br><br></code></pre></td></tr></table></figure>

<p>由于addr函数中的变量k在函数返回后就已经不存在了，但是在全局变量p中却保存了它的地址。在下一个函数port中，试图通过全局指针p访问一个不存在的变量，进而出错。</p>
<p><strong>在计算机系统，特别是嵌入式系统中，内存资源是非常有限的。尤其对于<code>移动端开发者</code>来说，硬件资源的限制使得其在程序设计中首要考虑的问题就是如何<code>有效地管理内存资源</code>。</strong></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E6%8A%80%E6%9C%AF%E6%A0%88/" class="category-chain-item">技术栈</a>
  
  
    <span>></span>
    
  <a href="/categories/%E6%8A%80%E6%9C%AF%E6%A0%88/C/" class="category-chain-item">C</a>
  
  

  

      </span>
    
  
</span>

    </div>
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>8、C语言常用函数</div>
      <div>http://example.com/2025/02/01/技术栈/C/第08章_C语言常用函数/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>pz</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2025年2月1日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/02/02/%E6%8A%80%E6%9C%AF%E6%A0%88/C/%E7%AC%AC09%E7%AB%A0_%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C/" title="9、文件操作">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">9、文件操作</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/02/01/%E6%8A%80%E6%9C%AF%E6%A0%88/C/%E7%AC%AC07%E7%AB%A0_%E7%BB%93%E6%9E%84%E4%BD%93%E4%B8%8E%E5%85%B1%E7%94%A8%E4%BD%93/" title="7、结构体与共用体">
                        <span class="hidden-mobile">7、结构体与共用体</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  









    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
<!-- hexo injector body_end start --><script src="/js/headerPic.js"></script><!-- hexo injector body_end end --></body>
</html>
